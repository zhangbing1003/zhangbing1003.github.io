$(document).ready(function(){function t(t){this.el=$(t.el),this.status=$.extend({},{init:{width:"100%",opacity:1,left:0,rotateZ:0,top:0}},t.status)}NexT.motion={};var e={lines:[],push:function(t){this.lines.push(t)},init:function(){this.lines.forEach(function(t){t.init()})},arrow:function(){this.lines.forEach(function(t){t.arrow()})},close:function(){this.lines.forEach(function(t){t.close()})}};t.prototype.init=function(){this.transform("init")},t.prototype.arrow=function(){this.transform("arrow")},t.prototype.close=function(){this.transform("close")},t.prototype.transform=function(t){this.el.velocity("stop").velocity(this.status[t])};var i=new t({el:".sidebar-toggle-line-first",status:{arrow:{width:"50%",rotateZ:"-45deg",top:"2px"},close:{width:"100%",rotateZ:"-45deg",top:"5px"}}}),o=new t({el:".sidebar-toggle-line-middle",status:{arrow:{width:"90%"},close:{opacity:0}}}),n=new t({el:".sidebar-toggle-line-last",status:{arrow:{width:"50%",rotateZ:"45deg",top:"-2px"},close:{width:"100%",rotateZ:"45deg",top:"-5px"}}});e.push(i),e.push(o),e.push(n);var s="320px",a=150,r={toggleEl:$(".sidebar-toggle"),sidebarEl:$(".sidebar"),isSidebarVisible:!1,init:function(){this.toggleEl.on("click",this.clickHandler.bind(this)),this.toggleEl.on("mouseenter",this.mouseEnterHandler.bind(this)),this.toggleEl.on("mouseleave",this.mouseLeaveHandler.bind(this)),$(document).on("sidebar.isShowing",function(){NexT.utils.isDesktop()&&$("body").velocity("stop").velocity({paddingRight:s},a)}).on("sidebar.isHiding",function(){})},clickHandler:function(){this.isSidebarVisible?this.hideSidebar():this.showSidebar(),this.isSidebarVisible=!this.isSidebarVisible},mouseEnterHandler:function(){this.isSidebarVisible||e.arrow()},mouseLeaveHandler:function(){this.isSidebarVisible||e.init()},showSidebar:function(){var t=this;e.close(),this.sidebarEl.velocity("stop").velocity({width:s},{display:"block",duration:a,begin:function(){$(".sidebar .motion-element").velocity("transition.slideRightIn",{stagger:20,drag:!0,complete:function(){t.sidebarEl.trigger("sidebar.motion.complete")}})},complete:function(){t.sidebarEl.addClass("sidebar-active"),t.sidebarEl.trigger("sidebar.didShow")}}),this.sidebarEl.trigger("sidebar.isShowing")},hideSidebar:function(){NexT.utils.isDesktop()&&$("body").velocity("stop").velocity({paddingRight:0}),this.sidebarEl.find(".motion-element").velocity("stop").css("display","none"),this.sidebarEl.velocity("stop").velocity({width:0},{display:"none"}),e.init(),this.sidebarEl.removeClass("sidebar-active"),this.sidebarEl.trigger("sidebar.isHiding"),$(".post-toc-wrap")&&"block"===$(".site-overview").css("display")&&$(".post-toc-wrap").removeClass("motion-element")}};r.init(),NexT.motion.integrator={queue:[],cursor:-1,add:function(t){return this.queue.push(t),this},next:function(){this.cursor++;var t=this.queue[this.cursor];$.isFunction(t)&&t(NexT.motion.integrator)},bootstrap:function(){this.next()}},NexT.motion.middleWares={logo:function(t){function e(t,e){return{e:$(t),p:{translateX:e},o:{duration:300,sequenceQueue:!1}}}function i(t){return t=Array.isArray(t)?t:[t],t.every(function(t){return $.isFunction(t.size)&&t.size()>0})}var o=[],n=$(".brand"),s=$(".site-title"),a=$(".site-subtitle"),r=$(".logo-line-before i"),l=$(".logo-line-after i");n.size()>0&&o.push({e:n,p:{opacity:1},o:{duration:150}}),NexT.utils.isMist()&&i([r,l])&&o.push(e(r,"100%"),e(l,"-100%")),i(s)&&o.push({e:s,p:{opacity:1,top:0},o:{duration:150}}),i(a)&&o.push({e:a,p:{opacity:1,top:0},o:{duration:150}}),o.length>0?(o[o.length-1].o.complete=function(){t.next()},$.Velocity.RunSequence(o)):t.next()},menu:function(t){$(".menu-item").velocity("transition.slideDownIn",{display:null,duration:200,complete:function(){t.next()}})},postList:function(t){function e(){var e=window.postMotionOptions||{stagger:10,drag:!0};e.complete=function(){t.next()},i.velocity("transition.slideDownIn",e)}var i=$(".post"),o=i.size()>0;o?e():t.next()},sidebar:function(t){"always"===CONFIG.sidebar&&NexT.utils.displaySidebar(),t.next()}}}),$(document).ready(function(){$(document).trigger("bootstrap:before"),NexT.utils.isMobile()&&window.FastClick.attach(document.body),$("#posts").find("img").lazyload({placeholder:"/images/loading.gif",effect:"fadeIn"}),$(".back-to-top").on("click",function(){$("body").velocity("scroll")}),$(".site-nav-toggle button").on("click",function(){var t=$(".site-nav"),e="site-nav-on",i=t.hasClass(e),o=i?"slideUp":"slideDown",n=i?"removeClass":"addClass";t.stop()[o]("fast",function(){t[n](e)})}),CONFIG.fancybox&&NexT.utils.wrapImageWithFancyBox(),NexT.utils.embeddedVideoTransformer(),NexT.utils.addActiveClassToMenuItem(),NexT.motion.integrator.add(NexT.motion.middleWares.logo).add(NexT.motion.middleWares.menu).add(NexT.motion.middleWares.postList).add(NexT.motion.middleWares.sidebar),$(document).trigger("motion:before"),CONFIG.motion&&NexT.motion.integrator.bootstrap(),$(document).trigger("bootstrap:after")}),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),n=o.data("bs.affix"),s="object"==typeof e&&e;n||o.data("bs.affix",n=new i(this,s)),"string"==typeof e&&n[e]()})}var i=function(e,o){this.options=t.extend({},i.DEFAULTS,o),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.3.5",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getState=function(t,e,i,o){var n=this.$target.scrollTop(),s=this.$element.offset(),a=this.$target.height();if(null!=i&&"top"==this.affixed)return i>n?"top":!1;if("bottom"==this.affixed)return null!=i?n+this.unpin<=s.top?!1:"bottom":t-o>=n+a?!1:"bottom";var r=null==this.affixed,l=r?n:s.top,c=r?a:e;return null!=i&&i>=n?"top":null!=o&&l+c>=t-o?"bottom":!1},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(i.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},i.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),o=this.options.offset,n=o.top,s=o.bottom,a=Math.max(t(document).height(),t(document.body).height());"object"!=typeof o&&(s=n=o),"function"==typeof n&&(n=o.top(this.$element)),"function"==typeof s&&(s=o.bottom(this.$element));var r=this.getState(a,e,n,s);if(this.affixed!=r){null!=this.unpin&&this.$element.css("top","");var l="affix"+(r?"-"+r:""),c=t.Event(l+".bs.affix");if(this.$element.trigger(c),c.isDefaultPrevented())return;this.affixed=r,this.unpin="bottom"==r?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==r&&this.$element.offset({top:a-e-s})}};var o=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=i,t.fn.affix.noConflict=function(){return t.fn.affix=o,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var i=t(this),o=i.data();o.offset=o.offset||{},null!=o.offsetBottom&&(o.offset.bottom=o.offsetBottom),null!=o.offsetTop&&(o.offset.top=o.offsetTop),e.call(i,o)})})}(jQuery),$(document).ready(function(){var t=$("#sidebar"),e=$(".header-inner").height(),i=parseInt($(".main").css("padding-bottom"),10),o=e+10;t.css({"margin-top":o}).show(),NexT.utils.isDesktop()&&$(".page-post-detail .sidebar-inner").affix({offset:{top:o,bottom:i}})});var $menu=$("#menu"),$menuItemSearch=$menu.find(".menu-item-search"),$siteSearch=$menu.find(".site-search");$menuItemSearch.click(function(){return $siteSearch.show(200),!1}),$menuItemSearch.on("mouseleave",function(){$siteSearch.hide(300)}),NexT.utils=NexT.$u={wrapImageWithFancyBox:function(){$(".content img").not(".group-picture img").each(function(){var t=$(this),e=t.attr("title"),i=t.parent("a");i.size()<1&&(i=t.wrap('<a href="'+this.getAttribute("src")+'"></a>').parent("a")),i.addClass("fancybox"),i.attr("rel","group"),e&&(i.append('<p class="image-caption">'+e+"</p>"),i.attr("title",e))}),$(".fancybox").fancybox({helpers:{overlay:{locked:!1}}})},embeddedVideoTransformer:function(){var t=$("iframe"),e=["www.youtube.com","player.vimeo.com","player.youku.com","music.163.com","www.tudou.com"],i=new RegExp(e.join("|"));t.each(function(){var t=this,e=$(this);if(this.src.search(i)>0){var o=e.height()/e.width()*100;this.src.search("music.163.com")>0&&(o+=10),e.width("100%").height("100%").css({position:"absolute",top:"0",left:"0"});var n=document.createElement("div");n.className="fluid-vids",n.style.width="100%",n.style.position="relative",n.style.paddingTop=o+"%";var s=t.parentNode;s.insertBefore(n,t),n.appendChild(t)}})},addActiveClassToMenuItem:function(){var t=window.location.href;$('.menu-item a[href="'+t+'"]').parent().addClass("menu-item-active")},hasMobileUA:function(){var t=window.navigator,e=t.userAgent,i=/iPad|iPhone|Android|Opera Mini|BlackBerry|webOS|UCWEB|Blazer|PSP|IEMobile|Symbian/g;return i.test(e)},isTablet:function(){return window.screen.width<992&&window.screen.width>767&&this.hasMobileUA()},isMobile:function(){return window.screen.width<767&&this.hasMobileUA()},isDesktop:function(){return!this.isTablet()&&!this.isMobile()},escapeSelector:function(t){return t.replace(/[!"$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")},displaySidebar:function(){this.isDesktop()&&$(".sidebar-toggle").trigger("click")},isMist:function(){return"Mist"===CONFIG.scheme},isPisces:function(){return"Pisces"===CONFIG.scheme}};